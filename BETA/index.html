<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Dokunmatik Destekli 3D Origami</title>
<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    background-color: #2c3e50;
    margin: 0;
    font-family: sans-serif;
    overflow: hidden;
  }

  .info-text {
    color: #ecf0f1;
    font-size: 16px;
    margin-bottom: 20px;
    text-align: center;
    padding: 0 20px;
  }

  /* 3D Kamera Perspektifi */
  .scene {
    perspective: 1500px;
  }

  /* Ana KaÄŸÄ±t AlanÄ± */
  .paper-container {
    position: relative;
    /* Mobilde daha iyi gÃ¶rÃ¼nmesi iÃ§in geniÅŸliÄŸi max-width ile sÄ±nÄ±rladÄ±k */
    width: 90vw; 
    max-width: 600px;
    height: 60vw;
    max-height: 400px;
    cursor: crosshair;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    background-color: #bdc3c7;
    
    /* Ã‡OK Ã–NEMLÄ°: Dokunmatik cihazlarda Ã§izim yaparken sayfanÄ±n kaymasÄ±nÄ± engeller */
    touch-action: none; 
  }

  /* KaÄŸÄ±dÄ±n Ä°ki ParÃ§asÄ± */
  .paper-layer {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: linear-gradient(135deg, #3498db 0%, #9b59b6 100%);
    background-image: repeating-linear-gradient(45deg, rgba(255,255,255,0.2) 25%, transparent 25%, transparent 75%, rgba(255,255,255,0.2) 75%, rgba(255,255,255,0.2));
    background-size: 40px 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: clamp(40px, 8vw, 80px); /* Ekran boyutuna gÃ¶re yazÄ± bÃ¼yÃ¼klÃ¼ÄŸÃ¼ */
    font-weight: bold;
    color: rgba(255,255,255,0.3);
    
    transform-style: preserve-3d;
    transition: transform 1s cubic-bezier(0.25, 0.8, 0.25, 1);
  }

  .draw-line {
    position: absolute;
    height: 3px;
    background-color: #f1c40f;
    transform-origin: 0 50%;
    pointer-events: none;
    z-index: 10;
    display: none;
    box-shadow: 0 0 10px #f1c40f;
  }

  #part1 { z-index: 2; }
  #part2 { z-index: 1; }

  #part1.folded {
    filter: drop-shadow(-5px 10px 15px rgba(0,0,0,0.4));
  }
</style>
</head>
<body>

  <div class="info-text">
    ğŸ‘† <b>Ã‡iz ve Katla:</b> Ekranda bir Ã§izgi Ã§ek ve bÄ±rak! <br>
    <span style="font-size: 14px; opacity: 0.8;">AÃ§mak iÃ§in tekrar dokun.</span>
  </div>

  <div class="scene">
    <div class="paper-container" id="paper">
      <div class="paper-layer" id="part2">KATLA</div>
      <div class="paper-layer" id="part1">KATLA</div>
      <div class="draw-line" id="line"></div>
    </div>
  </div>

  <script>
    const paper = document.getElementById('paper');
    const part1 = document.getElementById('part1');
    const part2 = document.getElementById('part2');
    const line = document.getElementById('line');
    
    let isDrawing = false;
    let isFolded = false;
    let startX, startY;

    // Fare ve Dokunmatik koordinatlarÄ±nÄ± ortak bir formatta alan yardÄ±mcÄ± fonksiyon
    function getPointerPos(e) {
      if (e.touches && e.touches.length > 0) {
        return { x: e.touches[0].clientX, y: e.touches[0].clientY };
      } else if (e.changedTouches && e.changedTouches.length > 0) {
        return { x: e.changedTouches[0].clientX, y: e.changedTouches[0].clientY };
      }
      return { x: e.clientX, y: e.clientY };
    }

    // Ã‡izime BaÅŸlama (Hem mousedown hem touchstart iÃ§in ortak)
    function handleStart(e) {
      if (isFolded) {
        part1.style.transform = 'none';
        part1.style.clipPath = 'none';
        part2.style.clipPath = 'none';
        part1.classList.remove('folded');
        line.style.display = 'none';
        isFolded = false;
        return;
      }

      const pos = getPointerPos(e);
      const rect = paper.getBoundingClientRect();
      startX = pos.x - rect.left;
      startY = pos.y - rect.top;
      isDrawing = true;
      
      line.style.display = 'block';
      line.style.width = '0px';
      line.style.left = startX + 'px';
      line.style.top = startY + 'px';
    }

    // Ã‡izgiyi SÃ¼rÃ¼kleme (Hem mousemove hem touchmove iÃ§in ortak)
    function handleMove(e) {
      if (!isDrawing) return;
      e.preventDefault(); // Dokunmatik ekranlarda kaydÄ±rmayÄ± engeller

      const pos = getPointerPos(e);
      const rect = paper.getBoundingClientRect();
      let currentX = pos.x - rect.left;
      let currentY = pos.y - rect.top;
      
      let dx = currentX - startX;
      let dy = currentY - startY;
      let length = Math.sqrt(dx*dx + dy*dy);
      let angle = Math.atan2(dy, dx) * 180 / Math.PI;
      
      line.style.width = length + 'px';
      line.style.transform = `rotate(${angle}deg)`;
    }

    // Ã‡izimi Bitirme ve Katlama (Hem mouseup hem touchend iÃ§in ortak)
    function handleEnd(e) {
      if (!isDrawing) return;
      isDrawing = false;
      
      const pos = getPointerPos(e);
      const rect = paper.getBoundingClientRect();
      let endX = pos.x - rect.left;
      let endY = pos.y - rect.top;
      
      let dx = endX - startX;
      let dy = endY - startY;
      let length = Math.sqrt(dx*dx + dy*dy);
      
      if (length < 20) { 
        line.style.display = 'none';
        return; 
      }

      let ux = dx / length;
      let uy = dy / length;
      let nx = -uy;
      let ny = ux;
      
      let K = 5000; 
      
      let p1x = startX - ux * K; let p1y = startY - uy * K;
      let p2x = startX + ux * K; let p2y = startY + uy * K;
      
      let c1x = p2x + nx * K; let c1y = p2y + ny * K;
      let c2x = p1x + nx * K; let c2y = p1y + ny * K;
      part1.style.clipPath = `polygon(${p1x}px ${p1y}px, ${p2x}px ${p2y}px, ${c1x}px ${c1y}px, ${c2x}px ${c2y}px)`;
      
      let c3x = p2x - nx * K; let c3y = p2y - ny * K;
      let c4x = p1x - nx * K; let c4y = p1y - ny * K;
      part2.style.clipPath = `polygon(${p1x}px ${p1y}px, ${p2x}px ${p2y}px, ${c3x}px ${c3y}px, ${c4x}px ${c4y}px)`;
      
      part1.style.transformOrigin = `${startX}px ${startY}px`;
      
      setTimeout(() => {
        part1.style.transform = `rotate3d(${dx}, ${dy}, 0, 179deg)`;
        part1.classList.add('folded');
        isFolded = true;
      }, 50);
    }

    // Fare Etkinlikleri
    paper.addEventListener('mousedown', handleStart);
    window.addEventListener('mousemove', handleMove); // Window'a baÄŸladÄ±k ki hÄ±zlÄ± Ã§izimlerde kaÄŸÄ±ttan Ã§Ä±kÄ±lsa bile Ã§izgi takip etsin
    window.addEventListener('mouseup', handleEnd);

    // Dokunmatik Etkinlikleri
    paper.addEventListener('touchstart', handleStart, { passive: false });
    window.addEventListener('touchmove', handleMove, { passive: false });
    window.addEventListener('touchend', handleEnd);
  </script>

</body>
</html>
